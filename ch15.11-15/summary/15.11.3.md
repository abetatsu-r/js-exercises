## 15.11.3 WebSocket

WebSocket APIはWebSocketプロトコルを用いて、サーバー・クライアント相互のネットワーク接続を提供する。
接続はブラウザがサーバとのHTTP通信を確立したのち、WebSocketプロトコルに切り替え、`wss`から始まるURLを接続エンドポイントに行う。

### 15.11.3.1 WebSocketの作成・接続・切断

WebSocket対応のサーバと通信するためには、URLを指定してWebSocketオブジェクトを作成する。作成された時点で通信が開始され、しばらくたったのちに接続が完了する。WebSocketオブジェクトは、`CONNECTING`、`OPEN`、`CLOSING`、`CLOSED`の4状態を持ち、`open`、`close`(、および`error`)についてはイベントリスナを設定することもできる。

### 15.11.3.2　WebSocketでメッセージを送信する

送信は`send()`メソッドに、Blob、ArrayBufferなどのメッセージを一つ引数にわたして実行すればよい。

### 15.11.3.3　WebSocketでメッセージを受信する

メッセージを受信する場合は、WebSocketオブジェクトに`message`イベントに対応するイベントハンドラを設定すればよい。
WebSocketで対応しているメッセージはUnicodeの単一文字列か、単一のバイト列のどちらかである。

### 15.11.3.4 プロトコルネゴシエーション

WebSocketプロトコルのではメッセージの交換方法をURLベースで定義することができる。
複数のバージョンのプロトコルに対して柔軟に対応したい場合は、WebSocketオブジェクトの第二引数に対応可能なプロトコルの一覧を文字列として渡すことで、サーバがプロトコルをその中で選択して処理することができるようになる。
